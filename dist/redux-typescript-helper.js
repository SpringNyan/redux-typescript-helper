!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rxjs/operators"),require("rxjs"),require("redux-observable"),require("immer"),require("reselect")):"function"==typeof define&&define.amd?define(["rxjs/operators","rxjs","redux-observable","immer","reselect"],t):"object"==typeof exports?exports["redux-typescript-helper"]=t(require("rxjs/operators"),require("rxjs"),require("redux-observable"),require("immer"),require("reselect")):e["redux-typescript-helper"]=t(e["rxjs/operators"],e.rxjs,e["redux-observable"],e.immer,e.reselect)}(window,function(e,t,r,n,o){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t,r){"use strict";r.r(t);var n={register:"@@REGISTER",epicEnd:"@@EPIC_END",unregister:"@@UNREGISTER"};function o(e){return null!=e&&e.type===this.type}function i(e){var t=function(t){return{type:e,payload:t}};return t.type=e,t.is=o,t}function s(e,t,r){var n={$namespace:t.join("/"),$parent:r};n.$root=null!=r?r.$root:n,n.$child=function(e){return n[e]};for(var o=0,c=Object.keys(e.reducers).concat(Object.keys(e.effects));o<c.length;o++){var u=c[o];n[u]=i(t.concat([u]).join("/"))}for(var l=0,a=Object.keys(e.models);l<a.length;l++){u=a[l];n[u]=s(e.models[u],t.concat([u]),n)}return n}var c=r(1),u=r(0),l=r(2);function a(e,t,r){return t.reduce(function(e,t){return null!=e?r?r(e,t):e[t]:void 0},e)}function d(e,t){return e.startsWith?e.startsWith(t):0===e.lastIndexOf(t,0)}function p(e){return new c.Observable(function(t){e(function(e){return t.next(e),e}).then(function(){return t.complete()},function(e){return t.error(e)})})}function f(e,t){var r=function(n){var o=r._nextId;r._nextId+=1;var i=new Promise(function(e,t){r._callbackById[o]={resolve:e,reject:t}}),s=function(){return delete r._callbackById[o]};return i.then(s,s),t({type:e,payload:n,__dispatch_id:o}),i};return r._nextId=1,r._callbackById={},r}function h(e,t,r,n){var o={$namespace:r.join("/"),$parent:n};o.$root=null!=n?n.$root:o,o.$child=function(e){return o[e]};for(var i=function(e){return t.$store.dispatch(e)},s=0,c=Object.keys(e.effects);s<c.length;s++){var u=c[s];o[u]=f(r.concat([u]).join("/"),i)}for(var l=0,a=Object.keys(e.models);l<a.length;l++){u=a[l];o[u]=h(e.models[u],t,r.concat([u]),o)}return o}function _(e,t,r,o){return function(i,s){var f=o.join("/"),h="/"+n.unregister,_=i.pipe(Object(u.filter)(function(e){return"string"==typeof e.type&&function(e,t){if(e.endsWith)return e.endsWith(t);var r=e.length-t.length;return r>=0&&e.lastIndexOf(t,r)===r}(e.type,h)&&d(f,e.type.substring(0,e.type.length-h.length))}));return c.merge.apply(void 0,function e(t,r,n,o,i){var s=[];for(var c=0,f=Object.keys(t.models);c<f.length;c++){var h=f[c],_=t.models[h],y=e(_,r,n,o,i.concat([h]));s.push.apply(s,y)}var b=new l.StateObservable(o.pipe(Object(u.map)(function(e){return a(e,i)}),Object(u.distinctUntilChanged)()),a(o.value,i));var m=a(r.$storeHelper,i,function(e,t){return e.$child(t)});var v=m.actions;var g=m.getters;var j=m.dispatch;var O=function(e){var c=t.effects[e],l=n.ofType(i.concat([e]).join("/")),a=l.pipe(Object(u.mergeMap)(function(t){var i=t.payload,s=c({action$:l,rootAction$:n,state$:b,rootState$:o,helper:m,actions:v,getters:g,dispatch:j,dependencies:r},i);if(null!=t.__dispatch_id){var u=s,a=t.__dispatch_id,d=j[e],f=d._callbackById[a],h=f.resolve,_=f.reject;s=function(e){var t=u(e);return t.then(h,_),t}}return p(s)}));s.push(a)};for(var $=0,x=Object.keys(t.effects);$<x.length;$++){var h=x[$];O(h)}var S=i.join("/")+"/";for(var w=0,E=t.epics;w<E.length;w++){var H=E[w],P=new l.ActionsObservable(n.pipe(Object(u.filter)(function(e){return"string"==typeof e.type&&d(e.type,S)}))),M=H({action$:P,rootAction$:n,state$:b,rootState$:o,helper:m,actions:v,getters:g,dispatch:j,dependencies:r});s.push(M)}return s}(e,t,i,s,o).map(function(e){return null!=r?e.pipe(Object(u.catchError)(r)):e})).pipe(Object(u.takeUntil)(_))}}var y=function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},b=function(){function e(e){this._isFrozen=!1,this._model=g(e)}return e.prototype.dependencies=function(){return this._isFrozen?this.clone().dependencies():this},e.prototype.state=function(e){if(this._isFrozen)return this.clone().state(e);var t=this._model.state,r=m(e);return this._model.state=null==t?r:function(e){return y({},t(e),r(e))},this},e.prototype.selectors=function(e){if(this._isFrozen)return this.clone().selectors(e);var t=this._model.selectors,r=m(e);return this._model.selectors=function(e){return y({},t(e),r(e))},this},e.prototype.reducers=function(e){return this._isFrozen?this.clone().reducers(e):(this._model.reducers=y({},this._model.reducers,e),this)},e.prototype.effects=function(e){return this._isFrozen?this.clone().effects(e):(this._model.effects=y({},this._model.effects,e),this)},e.prototype.epics=function(e){return this._isFrozen?this.clone().epics(e):(this._model.epics=this._model.epics.concat(e),this)},e.prototype.models=function(e){return this._isFrozen?this.clone().models(e):(this._model.models=y({},this._model.models,e),this)},e.prototype.dynamicModels=function(){return this._isFrozen?this.clone().dynamicModels():this},e.prototype.build=function(){if(null==this._model.state)throw new Error("state is not defined");return g(this._model)},e.prototype.clone=function(){return new e(this._model)},e.prototype.freeze=function(){return this._isFrozen=!0,this},e}();function m(e){return"function"==typeof e?e:function(){return e}}function v(){return new b({state:void 0,selectors:function(){return{}},reducers:{},effects:{},epics:[],models:{}})}function g(e){return{state:e.state,selectors:e.selectors,reducers:y({},e.reducers),effects:y({},e.effects),epics:e.epics.slice(),models:y({},e.models)}}var j=r(3),O=r.n(j),$=function(){return($=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function x(e,t){return function(r,o){return r=function e(t,r,n){void 0===t&&(t=r.state(n));var o=!1;var i={};for(var s=0,c=Object.keys(r.models);s<c.length;s++){var u=c[s],l=r.models[u],a=e(t[u],l,n);t[u]!==a&&(i[u]=a,o=!0)}return o?$({},t,i):t}(r,e,t),O()(r,function(t){var i=o.type.split("/"),s=a(t,i.slice(0,i.length-2)),c=a(e,i.slice(0,i.length-1),function(e,t){return e.models[t]}),u=i[i.length-2],l=i[i.length-1];l===n.unregister&&null!=s&&null!=u&&delete s[u];var d=null!=s&&null!=u?s[u]:void 0,p=null!=c?c.reducers[l]:void 0;if(null!=p){if(null==s||null==u)throw new Error("state not found");var f=a(r,i.slice(0,i.length-1)),h=p(d,o.payload,f);void 0!==h&&(s[u]=h)}})}}var S=r(4);function w(e,t,r,n){var o={get state(){return a(t.$store.getState(),r)},$namespace:r.join("/"),$parent:n};o.$root=null!=n?n.$root:o,o.$child=function(e){return o[e]};for(var i=e.selectors(S.createSelector),s=function(e){Object.defineProperty(o,e,{get:function(){return i[e]({get state(){return o.state},get rootState(){return o.$root.state},getters:o,dependencies:t})},enumerable:!0,configurable:!0})},c=0,u=Object.keys(i);c<u.length;c++){s(p=u[c])}for(var l=0,d=Object.keys(e.models);l<d.length;l++){var p=d[l];o[p]=w(e.models[p],t,r.concat([p]),o)}return o}var E=function(){function e(e,t,r){var n=this;this._model=t,this._options=r,this._dependencies={};for(var o=function(t){Object.defineProperty(i._dependencies,t,{get:function(){return e[t]},enumerable:!0,configurable:!0})},i=this,l=0,a=Object.keys(e);l<a.length;l++){o(a[l])}this._actions=s(this._model,[],null),this._getters=w(this._model,this._dependencies,[],null),this._dispatchers=h(this._model,this._dependencies,[],null),this._storeHelper=new P(this._model,this._dependencies,this._options,this._actions,this._getters,this._dispatchers,function(e){return n._addEpic$.next(e)},[],null),this._dependencies.$storeHelper=this._storeHelper,this._reducer=x(this._model,this._dependencies);var d=_(t,this._dependencies,this._options.epicErrorHandler||null,[]);this._addEpic$=new c.BehaviorSubject(d),this._epic=function(e,t,r){return n._addEpic$.pipe(Object(u.mergeMap)(function(n){return n(e,t,r)}))}}return Object.defineProperty(e.prototype,"reducer",{get:function(){return this._reducer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"epic",{get:function(){return this._epic},enumerable:!0,configurable:!0}),e.prototype.create=function(e){if(null!=this._store)throw new Error("store helper is already created");return this._store=e,this._dependencies.$store=this._store,this._storeHelper},e}();function H(e,t,r){return null==r&&(r={}),new E(e,t,r)}var P=function(){function e(e,t,r,n,o,i,s,c,u){this._subStoreHelpers={},this._model=e,this._dependencies=t,this._options=r,this._actions=n,this._getters=o,this._dispatchers=i,this._addEpic=s,this._namespaces=c,this.$namespace=c.join("/"),this.$parent=u,this.$root=null!=u?u.$root:this;for(var l=0,a=Object.keys(e.models);l<a.length;l++){var d=a[l];this._registerSubStoreHelper(d)}}return Object.defineProperty(e.prototype,"state",{get:function(){return a(this._store.getState(),this._namespaces)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actions",{get:function(){return this._actions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"getters",{get:function(){return this._getters},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dispatch",{get:function(){return this._dispatchers},enumerable:!0,configurable:!0}),e.prototype.$child=function(e){var t=this._subStoreHelpers[e];return null!=t?t:null},e.prototype.$registerModel=function(e,t){if(null!=this._model.models[e])throw new Error("model is already registered");this._model.models[e]=t;var r=this._namespaces.concat([e]);this._actions[e]=s(t,r,this._actions),this._getters[e]=w(t,this._dependencies,r,this._getters),this._registerSubStoreHelper(e),this._addEpic(_(t,this._dependencies,this._options.epicErrorHandler||null,r)),this._store.dispatch({type:r.join("/")+"/"+n.register})},e.prototype.$unregisterModel=function(e){if(null==this._model.models[e])throw new Error("model is already unregistered");var t=this._namespaces.concat([e]);this._store.dispatch({type:t.join("/")+"/"+n.epicEnd}),this._unregisterSubStoreHelper(e),delete this._actions[e],delete this._getters[e],this._store.dispatch({type:t.join("/")+"/"+n.unregister}),delete this._model.models[e]},Object.defineProperty(e.prototype,"_store",{get:function(){return this._dependencies.$store},enumerable:!0,configurable:!0}),e.prototype._registerSubStoreHelper=function(t){var r=this;this._subStoreHelpers[t]=new e(this._model.models[t],this._dependencies,this._options,this._actions[t],this._getters[t],this._dispatchers[t],this._addEpic,this._namespaces.concat([t]),this),Object.defineProperty(this,t,{get:function(){return r.$child(t)},enumerable:!0,configurable:!0})},e.prototype._unregisterSubStoreHelper=function(e){delete this[e],delete this._subStoreHelpers[e]},e}();r.d(t,"actionTypes",function(){return n}),r.d(t,"createActionHelper",function(){return i}),r.d(t,"createModelActionHelpers",function(){return s}),r.d(t,"toActionObservable",function(){return p}),r.d(t,"createModelActionDispatchers",function(){return h}),r.d(t,"createModelEpic",function(){return _}),r.d(t,"ModelBuilder",function(){return b}),r.d(t,"createModelBuilder",function(){return v}),r.d(t,"cloneModel",function(){return g}),r.d(t,"createModelReducer",function(){return x}),r.d(t,"createModelGetters",function(){return w}),r.d(t,"StoreHelperFactory",function(){return E}),r.d(t,"createStoreHelperFactory",function(){return H})}])});